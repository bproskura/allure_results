{"uid":"554beb9e070b06f","name":"Start new deal","fullName":"tests.deals.test_deal_actions.TestDealActions#test_start_deal","historyId":"5e695cec81a7c08859e89f48f53b1601","time":{"start":1727271410552,"stop":1727271428702,"duration":18150},"descriptionHtml":"<h4 style=\"margin: -10px 0 5px;\"><span style=\"margin: 9px 4px 9px 0; cursor: pointer\" class=\"fa fa-files-o\" data-copy=\"test_start_deal\"></span>test_start_deal</h4>\n    Collected at <span class=\"label label_status_passed\">2024-09-25 13:30</span><br><br>","status":"failed","statusMessage":"AssertionError: assert 'Available balance 0.397' in 'Available balance 0.3695409421 TRX is not enough to open buy order on market KISHU-TRX with amount 2.004 TRX and quantity 1477876106.1947 KISHU'\n +  where 'Available balance 0.397' = <built-in method format of str object at 0x7f05432a8770>('0.397')\n +    where <built-in method format of str object at 0x7f05432a8770> = 'Available balance {}'.format\n +  and   'Available balance 0.3695409421 TRX is not enough to open buy order on market KISHU-TRX with amount 2.004 TRX and quantity 1477876106.1947 KISHU' = get_unsuccessful_toast_message()\n +    where get_unsuccessful_toast_message = <src.pages.notifications.Notifications object at 0x7f052f482c60>.get_unsuccessful_toast_message","statusTrace":"self = <deals.test_deal_actions.TestDealActions object at 0x7f05432b9370>\npage = <Page url='https://darkbot:98713456@dev.app.darkbot.io/deals/b3141127-d65b-49f0-87cc-4f4d60d78e36'>\ncreate_session = <function create_session.<locals>._create_session at 0x7f052f4a5800>\n\n    @allure.title(\"Start new deal\")\n    def test_start_deal(self, page: Page, create_session):\n        deal_details_page = DealDetailsPage(page)\n        login_page = LoginPage(page)\n        notifications = Notifications(page)\n        deals_api = DealsApi()\n        failed_message = \"Available balance {}\"\n    \n        with allure.step(\"Test preparation\"):\n            ready_deals = deals_api.get_ready_deals()\n            total_deals = ready_deals['total']\n            deal_id = ready_deals['items'][0]['id']\n    \n            if total_deals == 0:\n                pytest.skip(\"There are no deals in Ready status\")\n            login_page.goto()\n            create_session()\n    \n        with allure.step(f\"Go to deals details page with id: {deal_id}\"):\n            deal_details_page.goto(endpoint=deal_details_page.slug.format(deal_id))\n    \n        with allure.step(\"Get available balance\"):\n            available_balance = deals_api.get_deal_available_balance(deal_id)\n    \n        with allure.step(\"Force start a deal\"):\n            deal_details_page.click_force_start_btn()\n    \n        with allure.step(\"Verify deal start\"):\n            if float(available_balance) <= 10:\n                assert notifications.wait_for_unsuccessful_toast() is True\n                available_balance = str(available_balance)[:5]\n>               assert failed_message.format(available_balance) in notifications.get_unsuccessful_toast_message()\nE               AssertionError: assert 'Available balance 0.397' in 'Available balance 0.3695409421 TRX is not enough to open buy order on market KISHU-TRX with amount 2.004 TRX and quantity 1477876106.1947 KISHU'\nE                +  where 'Available balance 0.397' = <built-in method format of str object at 0x7f05432a8770>('0.397')\nE                +    where <built-in method format of str object at 0x7f05432a8770> = 'Available balance {}'.format\nE                +  and   'Available balance 0.3695409421 TRX is not enough to open buy order on market KISHU-TRX with amount 2.004 TRX and quantity 1477876106.1947 KISHU' = get_unsuccessful_toast_message()\nE                +    where get_unsuccessful_toast_message = <src.pages.notifications.Notifications object at 0x7f052f482c60>.get_unsuccessful_toast_message\n\navailable_balance = '0.397'\ncreate_session = <function create_session.<locals>._create_session at 0x7f052f4a5800>\ndeal_details_page = <src.pages.deal_details_page.deal_details_page.DealDetailsPage object at 0x7f052f482ba0>\ndeal_id    = 'b3141127-d65b-49f0-87cc-4f4d60d78e36'\ndeals_api  = <src.api.deals.deals_api.DealsApi object at 0x7f052f482cf0>\nfailed_message = 'Available balance {}'\nlogin_page = <src.pages.login_page.login_page.LoginPage object at 0x7f052f482bd0>\nnotifications = <src.pages.notifications.Notifications object at 0x7f052f482c60>\npage       = <Page url='https://darkbot:98713456@dev.app.darkbot.io/deals/b3141127-d65b-49f0-87cc-4f4d60d78e36'>\nready_deals = {'items': [{'actions': {'cancel': True, 'complete': False, 'restart': False, 'run': True, ...}, 'assessedValue': {'amo...tadata': {'statistics': {'cancelled': 23, 'completed': 423, 'ready': 784, 'running': 32}}, 'page': 1, 'pages': 79, ...}\nself       = <deals.test_deal_actions.TestDealActions object at 0x7f05432b9370>\ntotal_deals = 784\n\ntests/deals/test_deal_actions.py:48: AssertionError","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":1,"retriesStatusChange":false,"beforeStages":[{"name":"context","time":{"start":1727271410360,"stop":1727271410515,"duration":155},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"page","time":{"start":1727271410515,"stop":1727271410551,"duration":36},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"create_session","time":{"start":1727271410551,"stop":1727271410552,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"testStage":{"descriptionHtml":"<h4 style=\"margin: -10px 0 5px;\"><span style=\"margin: 9px 4px 9px 0; cursor: pointer\" class=\"fa fa-files-o\" data-copy=\"test_start_deal\"></span>test_start_deal</h4>\n    Collected at <span class=\"label label_status_passed\">2024-09-25 13:30</span><br><br>","status":"failed","statusMessage":"AssertionError: assert 'Available balance 0.397' in 'Available balance 0.3695409421 TRX is not enough to open buy order on market KISHU-TRX with amount 2.004 TRX and quantity 1477876106.1947 KISHU'\n +  where 'Available balance 0.397' = <built-in method format of str object at 0x7f05432a8770>('0.397')\n +    where <built-in method format of str object at 0x7f05432a8770> = 'Available balance {}'.format\n +  and   'Available balance 0.3695409421 TRX is not enough to open buy order on market KISHU-TRX with amount 2.004 TRX and quantity 1477876106.1947 KISHU' = get_unsuccessful_toast_message()\n +    where get_unsuccessful_toast_message = <src.pages.notifications.Notifications object at 0x7f052f482c60>.get_unsuccessful_toast_message","statusTrace":"self = <deals.test_deal_actions.TestDealActions object at 0x7f05432b9370>\npage = <Page url='https://darkbot:98713456@dev.app.darkbot.io/deals/b3141127-d65b-49f0-87cc-4f4d60d78e36'>\ncreate_session = <function create_session.<locals>._create_session at 0x7f052f4a5800>\n\n    @allure.title(\"Start new deal\")\n    def test_start_deal(self, page: Page, create_session):\n        deal_details_page = DealDetailsPage(page)\n        login_page = LoginPage(page)\n        notifications = Notifications(page)\n        deals_api = DealsApi()\n        failed_message = \"Available balance {}\"\n    \n        with allure.step(\"Test preparation\"):\n            ready_deals = deals_api.get_ready_deals()\n            total_deals = ready_deals['total']\n            deal_id = ready_deals['items'][0]['id']\n    \n            if total_deals == 0:\n                pytest.skip(\"There are no deals in Ready status\")\n            login_page.goto()\n            create_session()\n    \n        with allure.step(f\"Go to deals details page with id: {deal_id}\"):\n            deal_details_page.goto(endpoint=deal_details_page.slug.format(deal_id))\n    \n        with allure.step(\"Get available balance\"):\n            available_balance = deals_api.get_deal_available_balance(deal_id)\n    \n        with allure.step(\"Force start a deal\"):\n            deal_details_page.click_force_start_btn()\n    \n        with allure.step(\"Verify deal start\"):\n            if float(available_balance) <= 10:\n                assert notifications.wait_for_unsuccessful_toast() is True\n                available_balance = str(available_balance)[:5]\n>               assert failed_message.format(available_balance) in notifications.get_unsuccessful_toast_message()\nE               AssertionError: assert 'Available balance 0.397' in 'Available balance 0.3695409421 TRX is not enough to open buy order on market KISHU-TRX with amount 2.004 TRX and quantity 1477876106.1947 KISHU'\nE                +  where 'Available balance 0.397' = <built-in method format of str object at 0x7f05432a8770>('0.397')\nE                +    where <built-in method format of str object at 0x7f05432a8770> = 'Available balance {}'.format\nE                +  and   'Available balance 0.3695409421 TRX is not enough to open buy order on market KISHU-TRX with amount 2.004 TRX and quantity 1477876106.1947 KISHU' = get_unsuccessful_toast_message()\nE                +    where get_unsuccessful_toast_message = <src.pages.notifications.Notifications object at 0x7f052f482c60>.get_unsuccessful_toast_message\n\navailable_balance = '0.397'\ncreate_session = <function create_session.<locals>._create_session at 0x7f052f4a5800>\ndeal_details_page = <src.pages.deal_details_page.deal_details_page.DealDetailsPage object at 0x7f052f482ba0>\ndeal_id    = 'b3141127-d65b-49f0-87cc-4f4d60d78e36'\ndeals_api  = <src.api.deals.deals_api.DealsApi object at 0x7f052f482cf0>\nfailed_message = 'Available balance {}'\nlogin_page = <src.pages.login_page.login_page.LoginPage object at 0x7f052f482bd0>\nnotifications = <src.pages.notifications.Notifications object at 0x7f052f482c60>\npage       = <Page url='https://darkbot:98713456@dev.app.darkbot.io/deals/b3141127-d65b-49f0-87cc-4f4d60d78e36'>\nready_deals = {'items': [{'actions': {'cancel': True, 'complete': False, 'restart': False, 'run': True, ...}, 'assessedValue': {'amo...tadata': {'statistics': {'cancelled': 23, 'completed': 423, 'ready': 784, 'running': 32}}, 'page': 1, 'pages': 79, ...}\nself       = <deals.test_deal_actions.TestDealActions object at 0x7f05432b9370>\ntotal_deals = 784\n\ntests/deals/test_deal_actions.py:48: AssertionError","steps":[{"name":"Test preparation","time":{"start":1727271412238,"stop":1727271419075,"duration":6837},"status":"passed","steps":[{"name":"goto route","time":{"start":1727271413993,"stop":1727271415245,"duration":1252},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true},{"name":"Go to deals details page with id: b3141127-d65b-49f0-87cc-4f4d60d78e36","time":{"start":1727271419075,"stop":1727271419641,"duration":566},"status":"passed","steps":[{"name":"goto route","time":{"start":1727271419075,"stop":1727271419641,"duration":566},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true},{"name":"Get available balance","time":{"start":1727271419641,"stop":1727271423981,"duration":4340},"status":"passed","steps":[{"name":"Get available deal balance","time":{"start":1727271419641,"stop":1727271423981,"duration":4340},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"deal_id","value":"'b3141127-d65b-49f0-87cc-4f4d60d78e36'"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true},{"name":"Force start a deal","time":{"start":1727271423981,"stop":1727271426387,"duration":2406},"status":"passed","steps":[{"name":"Click on Force start deal btn","time":{"start":1727271423981,"stop":1727271426387,"duration":2406},"status":"passed","steps":[{"name":"click button","time":{"start":1727271423981,"stop":1727271426387,"duration":2406},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"locator","value":"'//button[text() = 'Force start']'"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true},{"name":"Verify deal start","time":{"start":1727271426387,"stop":1727271428701,"duration":2314},"status":"failed","statusMessage":"AssertionError: assert 'Available balance 0.397' in 'Available balance 0.3695409421 TRX is not enough to open buy order on market KISHU-TRX with amount 2.004 TRX and quantity 1477876106.1947 KISHU'\n +  where 'Available balance 0.397' = <built-in method format of str object at 0x7f05432a8770>('0.397')\n +    where <built-in method format of str object at 0x7f05432a8770> = 'Available balance {}'.format\n +  and   'Available balance 0.3695409421 TRX is not enough to open buy order on market KISHU-TRX with amount 2.004 TRX and quantity 1477876106.1947 KISHU' = get_unsuccessful_toast_message()\n +    where get_unsuccessful_toast_message = <src.pages.notifications.Notifications object at 0x7f052f482c60>.get_unsuccessful_toast_message\n","statusTrace":"  File \"/home/runner/work/qa-website/qa-website/tests/deals/test_deal_actions.py\", line 48, in test_start_deal\n    assert failed_message.format(available_balance) in notifications.get_unsuccessful_toast_message()\n","steps":[{"name":"Wait for unsuccessful toast notification","time":{"start":1727271426387,"stop":1727271428697,"duration":2310},"status":"passed","steps":[{"name":"wait for selector","time":{"start":1727271426387,"stop":1727271428696,"duration":2309},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"locator","value":"'//div[@type='error']'"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true},{"name":"Get unsuccessful toast message","time":{"start":1727271428697,"stop":1727271428701,"duration":4},"status":"passed","steps":[{"name":"get_text","time":{"start":1727271428697,"stop":1727271428701,"duration":4},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"locator","value":"'//div[@type='error']'"},{"name":"index","value":"0"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":4,"attachmentsCount":0,"hasContent":true}],"attachments":[{"uid":"367cd6d9c80086","name":"Location","source":"367cd6d9c80086.uri","type":"text/uri-list","size":86},{"uid":"7aac6e1da98e5a32","name":"Screenshot","source":"7aac6e1da98e5a32.png","type":"image/png","size":174797},{"uid":"18a35c3b66667e6a","name":"log","source":"18a35c3b66667e6a.txt","type":"text/plain","size":1895}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":14,"attachmentsCount":3,"hasContent":true},"afterStages":[{"name":"context::0","time":{"start":1727271428819,"stop":1727271428883,"duration":64},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"labels":[{"name":"suite","value":"Deal Actions"},{"name":"parentSuite","value":"tests.deals"},{"name":"subSuite","value":"TestDealActions"},{"name":"host","value":"fv-az676-644"},{"name":"thread","value":"5427-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.deals.test_deal_actions"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"476584d6d5c3157c","status":"failed","statusDetails":"AssertionError: assert 'Available balance 0.397' in 'Available balance 0.3695409421 TRX is not enough to open buy order on market KISHU-TRX with amount 2.004 TRX and quantity 1477876106.1947 KISHU'\n +  where 'Available balance 0.397' = <built-in method format of str object at 0x7f05432a8770>('0.397')\n +    where <built-in method format of str object at 0x7f05432a8770> = 'Available balance {}'.format\n +  and   'Available balance 0.3695409421 TRX is not enough to open buy order on market KISHU-TRX with amount 2.004 TRX and quantity 1477876106.1947 KISHU' = get_unsuccessful_toast_message()\n +    where get_unsuccessful_toast_message = <src.pages.notifications.Notifications object at 0x7f052f412c30>.get_unsuccessful_toast_message","time":{"start":1727271391672,"stop":1727271410161,"duration":18489}}],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":2,"broken":1,"skipped":0,"passed":1,"unknown":0,"total":4},"items":[{"uid":"3d54c7acf06cd016","reportUrl":"https://darkbot-io.github.io/qa-website/532//#testresult/3d54c7acf06cd016","status":"broken","statusDetails":"requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://dev.api.darkbot.io/auth/login","time":{"start":1726945019571,"stop":1726945020376,"duration":805}},{"uid":"cb7f5d2860624148","reportUrl":"https://darkbot-io.github.io/qa-website/531//#testresult/cb7f5d2860624148","status":"failed","statusDetails":"AssertionError: assert 'Available balance 1.701' in 'Available balance 1.6908126700 TRX is not enough to open buy order on market LINK-TRX with amount 2 TRX and quantity 0.0276128675963 LINK'\n +  where 'Available balance 1.701' = <built-in method format of str object at 0x7f1cd0f60170>('1.701')\n +    where <built-in method format of str object at 0x7f1cd0f60170> = 'Available balance {}'.format\n +  and   'Available balance 1.6908126700 TRX is not enough to open buy order on market LINK-TRX with amount 2 TRX and quantity 0.0276128675963 LINK' = get_unsuccessful_toast_message()\n +    where get_unsuccessful_toast_message = <src.pages.notifications.Notifications object at 0x7f1cbd9e5310>.get_unsuccessful_toast_message","time":{"start":1726943274315,"stop":1726943294352,"duration":20037}},{"uid":"879df8dac18f330c","reportUrl":"https://darkbot-io.github.io/qa-website/529//#testresult/879df8dac18f330c","status":"passed","time":{"start":1726772706324,"stop":1726772727547,"duration":21223}}]},"tags":[]},"source":"554beb9e070b06f.json","parameterValues":[]}