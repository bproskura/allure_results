{"uid":"adc7c22777b1a549","name":"Open deal new buy trade request","fullName":"tests.deals.test_deal_actions.TestDealActions#test_open_new_buy_trade_request","historyId":"8383274ee358a5839153a5ca7ad12a34","time":{"start":1729358168469,"stop":1729358186765,"duration":18296},"descriptionHtml":"<h4 style=\"margin: -10px 0 5px;\"><span style=\"margin: 9px 4px 9px 0; cursor: pointer\" class=\"fa fa-files-o\" data-copy=\"test_open_new_buy_trade_request\"></span>test_open_new_buy_trade_request</h4>\n    Collected at <span class=\"label label_status_passed\">2024-10-19 17:09</span><br><br>","status":"failed","statusMessage":"AssertionError: assert 'Available balance 0.599' in 'Available balance 0.5592953580 TRX is not enough to open buy order on market LINK-TRX with amount 2 TRX and quantity 0.028324599915026 LINK'\n +  where 'Available balance 0.599' = <built-in method format of str object at 0x7f0a0225ecb0>('0.599')\n +    where <built-in method format of str object at 0x7f0a0225ecb0> = 'Available balance {}'.format\n +  and   'Available balance 0.5592953580 TRX is not enough to open buy order on market LINK-TRX with amount 2 TRX and quantity 0.028324599915026 LINK' = get_unsuccessful_toast_message()\n +    where get_unsuccessful_toast_message = <src.pages.notifications.Notifications object at 0x7f0a0333c500>.get_unsuccessful_toast_message","statusTrace":"self = <deals.test_deal_actions.TestDealActions object at 0x7f0a03d4b0e0>\npage = <Page url='https://darkbot:98713456@dev.app.darkbot.io/deals/345e0fbe-7789-4a55-99ef-f232875a84ee'>\ncreate_session = <function create_session.<locals>._create_session at 0x7f09f1137380>\n\n    @allure.title(\"Open deal new buy trade request\")\n    def test_open_new_buy_trade_request(self, page: Page, create_session):\n        deal_details_page = DealDetailsPage(page)\n        login_page = LoginPage(page)\n        notifications = Notifications(page)\n        deals_api = DealsApi()\n        failed_message = \"Available balance {}\"\n    \n        with allure.step(\"Test preparation\"):\n            running_deals = deals_api.get_poloniex_running_deals()\n            total_deals = running_deals['total']\n            deal_id = None\n    \n            if total_deals == 0:\n                pytest.skip(\"There are no deals in Running status\")\n    \n            for deal in running_deals['items']:\n                if deal['actions']['trade']:\n                    deal_id = deal['id']\n                    break\n    \n            if deal_id is None:\n                pytest.skip(\"There are no deals with 'trade' action available\")\n    \n            login_page.goto()\n            create_session()\n    \n        with allure.step(f\"Go to deals details page with id: {deal_id}\"):\n            deal_details_page.goto(endpoint=deal_details_page.slug.format(deal_id))\n    \n        with allure.step(\"Get available balance\"):\n            available_balance = deals_api.get_deal_available_balance(deal_id)\n    \n        with allure.step(\"Open new buy trade request\"):\n            deal_details_page.click_open_new_buy_btn()\n    \n        with allure.step(\"Verify deal start\"):\n            if float(available_balance) <= 10:\n                assert notifications.wait_for_unsuccessful_toast() is True\n                available_balance = str(available_balance)[:5]\n>               assert failed_message.format(available_balance) in notifications.get_unsuccessful_toast_message()\nE               AssertionError: assert 'Available balance 0.599' in 'Available balance 0.5592953580 TRX is not enough to open buy order on market LINK-TRX with amount 2 TRX and quantity 0.028324599915026 LINK'\nE                +  where 'Available balance 0.599' = <built-in method format of str object at 0x7f0a0225ecb0>('0.599')\nE                +    where <built-in method format of str object at 0x7f0a0225ecb0> = 'Available balance {}'.format\nE                +  and   'Available balance 0.5592953580 TRX is not enough to open buy order on market LINK-TRX with amount 2 TRX and quantity 0.028324599915026 LINK' = get_unsuccessful_toast_message()\nE                +    where get_unsuccessful_toast_message = <src.pages.notifications.Notifications object at 0x7f0a0333c500>.get_unsuccessful_toast_message\n\navailable_balance = '0.599'\ncreate_session = <function create_session.<locals>._create_session at 0x7f09f1137380>\ndeal       = {'actions': {'cancel': False, 'complete': True, 'restart': False, 'run': False, ...}, 'assessedValue': {'amount': '3.99041817', 'asset': 'TRX'}, 'assets': {'base': 'LINK', 'quote': 'TRX'}, 'avgBuyRate': '75.075968407842', ...}\ndeal_details_page = <src.pages.deal_details_page.deal_details_page.DealDetailsPage object at 0x7f0a0333c1d0>\ndeal_id    = '345e0fbe-7789-4a55-99ef-f232875a84ee'\ndeals_api  = <src.api.deals.deals_api.DealsApi object at 0x7f0a0333cec0>\nfailed_message = 'Available balance {}'\nlogin_page = <src.pages.login_page.login_page.LoginPage object at 0x7f0a0333ce60>\nnotifications = <src.pages.notifications.Notifications object at 0x7f0a0333c500>\npage       = <Page url='https://darkbot:98713456@dev.app.darkbot.io/deals/345e0fbe-7789-4a55-99ef-f232875a84ee'>\nrunning_deals = {'items': [{'actions': {'cancel': False, 'complete': False, 'restart': False, 'run': False, ...}, 'assessedValue': {'a...tadata': {'statistics': {'cancelled': 24, 'completed': 433, 'ready': 2444, 'running': 27}}, 'page': 1, 'pages': 3, ...}\nself       = <deals.test_deal_actions.TestDealActions object at 0x7f0a03d4b0e0>\ntotal_deals = 21\n\ntests/deals/test_deal_actions.py:181: AssertionError","flaky":true,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":1,"retriesStatusChange":false,"beforeStages":[{"name":"context","time":{"start":1729358168252,"stop":1729358168430,"duration":178},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"page","time":{"start":1729358168430,"stop":1729358168468,"duration":38},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"create_session","time":{"start":1729358168468,"stop":1729358168468,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"testStage":{"descriptionHtml":"<h4 style=\"margin: -10px 0 5px;\"><span style=\"margin: 9px 4px 9px 0; cursor: pointer\" class=\"fa fa-files-o\" data-copy=\"test_open_new_buy_trade_request\"></span>test_open_new_buy_trade_request</h4>\n    Collected at <span class=\"label label_status_passed\">2024-10-19 17:09</span><br><br>","status":"failed","statusMessage":"AssertionError: assert 'Available balance 0.599' in 'Available balance 0.5592953580 TRX is not enough to open buy order on market LINK-TRX with amount 2 TRX and quantity 0.028324599915026 LINK'\n +  where 'Available balance 0.599' = <built-in method format of str object at 0x7f0a0225ecb0>('0.599')\n +    where <built-in method format of str object at 0x7f0a0225ecb0> = 'Available balance {}'.format\n +  and   'Available balance 0.5592953580 TRX is not enough to open buy order on market LINK-TRX with amount 2 TRX and quantity 0.028324599915026 LINK' = get_unsuccessful_toast_message()\n +    where get_unsuccessful_toast_message = <src.pages.notifications.Notifications object at 0x7f0a0333c500>.get_unsuccessful_toast_message","statusTrace":"self = <deals.test_deal_actions.TestDealActions object at 0x7f0a03d4b0e0>\npage = <Page url='https://darkbot:98713456@dev.app.darkbot.io/deals/345e0fbe-7789-4a55-99ef-f232875a84ee'>\ncreate_session = <function create_session.<locals>._create_session at 0x7f09f1137380>\n\n    @allure.title(\"Open deal new buy trade request\")\n    def test_open_new_buy_trade_request(self, page: Page, create_session):\n        deal_details_page = DealDetailsPage(page)\n        login_page = LoginPage(page)\n        notifications = Notifications(page)\n        deals_api = DealsApi()\n        failed_message = \"Available balance {}\"\n    \n        with allure.step(\"Test preparation\"):\n            running_deals = deals_api.get_poloniex_running_deals()\n            total_deals = running_deals['total']\n            deal_id = None\n    \n            if total_deals == 0:\n                pytest.skip(\"There are no deals in Running status\")\n    \n            for deal in running_deals['items']:\n                if deal['actions']['trade']:\n                    deal_id = deal['id']\n                    break\n    \n            if deal_id is None:\n                pytest.skip(\"There are no deals with 'trade' action available\")\n    \n            login_page.goto()\n            create_session()\n    \n        with allure.step(f\"Go to deals details page with id: {deal_id}\"):\n            deal_details_page.goto(endpoint=deal_details_page.slug.format(deal_id))\n    \n        with allure.step(\"Get available balance\"):\n            available_balance = deals_api.get_deal_available_balance(deal_id)\n    \n        with allure.step(\"Open new buy trade request\"):\n            deal_details_page.click_open_new_buy_btn()\n    \n        with allure.step(\"Verify deal start\"):\n            if float(available_balance) <= 10:\n                assert notifications.wait_for_unsuccessful_toast() is True\n                available_balance = str(available_balance)[:5]\n>               assert failed_message.format(available_balance) in notifications.get_unsuccessful_toast_message()\nE               AssertionError: assert 'Available balance 0.599' in 'Available balance 0.5592953580 TRX is not enough to open buy order on market LINK-TRX with amount 2 TRX and quantity 0.028324599915026 LINK'\nE                +  where 'Available balance 0.599' = <built-in method format of str object at 0x7f0a0225ecb0>('0.599')\nE                +    where <built-in method format of str object at 0x7f0a0225ecb0> = 'Available balance {}'.format\nE                +  and   'Available balance 0.5592953580 TRX is not enough to open buy order on market LINK-TRX with amount 2 TRX and quantity 0.028324599915026 LINK' = get_unsuccessful_toast_message()\nE                +    where get_unsuccessful_toast_message = <src.pages.notifications.Notifications object at 0x7f0a0333c500>.get_unsuccessful_toast_message\n\navailable_balance = '0.599'\ncreate_session = <function create_session.<locals>._create_session at 0x7f09f1137380>\ndeal       = {'actions': {'cancel': False, 'complete': True, 'restart': False, 'run': False, ...}, 'assessedValue': {'amount': '3.99041817', 'asset': 'TRX'}, 'assets': {'base': 'LINK', 'quote': 'TRX'}, 'avgBuyRate': '75.075968407842', ...}\ndeal_details_page = <src.pages.deal_details_page.deal_details_page.DealDetailsPage object at 0x7f0a0333c1d0>\ndeal_id    = '345e0fbe-7789-4a55-99ef-f232875a84ee'\ndeals_api  = <src.api.deals.deals_api.DealsApi object at 0x7f0a0333cec0>\nfailed_message = 'Available balance {}'\nlogin_page = <src.pages.login_page.login_page.LoginPage object at 0x7f0a0333ce60>\nnotifications = <src.pages.notifications.Notifications object at 0x7f0a0333c500>\npage       = <Page url='https://darkbot:98713456@dev.app.darkbot.io/deals/345e0fbe-7789-4a55-99ef-f232875a84ee'>\nrunning_deals = {'items': [{'actions': {'cancel': False, 'complete': False, 'restart': False, 'run': False, ...}, 'assessedValue': {'a...tadata': {'statistics': {'cancelled': 24, 'completed': 433, 'ready': 2444, 'running': 27}}, 'page': 1, 'pages': 3, ...}\nself       = <deals.test_deal_actions.TestDealActions object at 0x7f0a03d4b0e0>\ntotal_deals = 21\n\ntests/deals/test_deal_actions.py:181: AssertionError","steps":[{"name":"Test preparation","time":{"start":1729358170193,"stop":1729358176773,"duration":6580},"status":"passed","steps":[{"name":"goto route","time":{"start":1729358171933,"stop":1729358173199,"duration":1266},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true},{"name":"Go to deals details page with id: 345e0fbe-7789-4a55-99ef-f232875a84ee","time":{"start":1729358176773,"stop":1729358177303,"duration":530},"status":"passed","steps":[{"name":"goto route","time":{"start":1729358176773,"stop":1729358177303,"duration":530},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true},{"name":"Get available balance","time":{"start":1729358177303,"stop":1729358182051,"duration":4748},"status":"passed","steps":[{"name":"Get available deal balance","time":{"start":1729358177303,"stop":1729358182051,"duration":4748},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"deal_id","value":"'345e0fbe-7789-4a55-99ef-f232875a84ee'"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true},{"name":"Open new buy trade request","time":{"start":1729358182051,"stop":1729358184453,"duration":2402},"status":"passed","steps":[{"name":"Click on open new buy trade request btn","time":{"start":1729358182051,"stop":1729358184453,"duration":2402},"status":"passed","steps":[{"name":"click button","time":{"start":1729358182051,"stop":1729358184453,"duration":2402},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"locator","value":"'//*[text()='Open new BUY']'"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true},{"name":"Verify deal start","time":{"start":1729358184453,"stop":1729358186765,"duration":2312},"status":"failed","statusMessage":"AssertionError: assert 'Available balance 0.599' in 'Available balance 0.5592953580 TRX is not enough to open buy order on market LINK-TRX with amount 2 TRX and quantity 0.028324599915026 LINK'\n +  where 'Available balance 0.599' = <built-in method format of str object at 0x7f0a0225ecb0>('0.599')\n +    where <built-in method format of str object at 0x7f0a0225ecb0> = 'Available balance {}'.format\n +  and   'Available balance 0.5592953580 TRX is not enough to open buy order on market LINK-TRX with amount 2 TRX and quantity 0.028324599915026 LINK' = get_unsuccessful_toast_message()\n +    where get_unsuccessful_toast_message = <src.pages.notifications.Notifications object at 0x7f0a0333c500>.get_unsuccessful_toast_message\n","statusTrace":"  File \"/home/runner/work/qa-website/qa-website/tests/deals/test_deal_actions.py\", line 181, in test_open_new_buy_trade_request\n    assert failed_message.format(available_balance) in notifications.get_unsuccessful_toast_message()\n","steps":[{"name":"Wait for unsuccessful toast notification","time":{"start":1729358184453,"stop":1729358186760,"duration":2307},"status":"passed","steps":[{"name":"wait for selector","time":{"start":1729358184453,"stop":1729358186760,"duration":2307},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"locator","value":"'//div[@type='error']'"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true},{"name":"Get unsuccessful toast message","time":{"start":1729358186760,"stop":1729358186764,"duration":4},"status":"passed","steps":[{"name":"get_text","time":{"start":1729358186760,"stop":1729358186764,"duration":4},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"locator","value":"'//div[@type='error']'"},{"name":"index","value":"0"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":4,"attachmentsCount":0,"hasContent":true}],"attachments":[{"uid":"b971a9ab607f517e","name":"Location","source":"b971a9ab607f517e.uri","type":"text/uri-list","size":86},{"uid":"1a17a2551423c911","name":"Screenshot","source":"1a17a2551423c911.png","type":"image/png","size":172297},{"uid":"ec12c3534548d65b","name":"log","source":"ec12c3534548d65b.txt","type":"text/plain","size":2013}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":14,"attachmentsCount":3,"hasContent":true},"afterStages":[{"name":"context::0","time":{"start":1729358186875,"stop":1729358186944,"duration":69},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"labels":[{"name":"suite","value":"Deal Actions"},{"name":"parentSuite","value":"tests.deals"},{"name":"subSuite","value":"TestDealActions"},{"name":"host","value":"fv-az1385-738"},{"name":"thread","value":"5469-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.deals.test_deal_actions"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"26f93d7d72401426","status":"failed","statusDetails":"AssertionError: assert 'Available balance 0.599' in 'Available balance 0.5592953580 TRX is not enough to open buy order on market LINK-TRX with amount 2 TRX and quantity 0.028324599915026 LINK'\n +  where 'Available balance 0.599' = <built-in method format of str object at 0x7f0a0225ecb0>('0.599')\n +    where <built-in method format of str object at 0x7f0a0225ecb0> = 'Available balance {}'.format\n +  and   'Available balance 0.5592953580 TRX is not enough to open buy order on market LINK-TRX with amount 2 TRX and quantity 0.028324599915026 LINK' = get_unsuccessful_toast_message()\n +    where get_unsuccessful_toast_message = <src.pages.notifications.Notifications object at 0x7f0a03360a70>.get_unsuccessful_toast_message","time":{"start":1729358149595,"stop":1729358168057,"duration":18462}}],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":2,"broken":3,"skipped":0,"passed":3,"unknown":0,"total":8},"items":[{"uid":"b234ad11469b15d1","reportUrl":"https://darkbot-io.github.io/qa-website/536//#testresult/b234ad11469b15d1","status":"passed","time":{"start":1728753415261,"stop":1728753433986,"duration":18725}},{"uid":"6a3e01ab896d5b7","reportUrl":"https://darkbot-io.github.io/qa-website/535//#testresult/6a3e01ab896d5b7","status":"broken","statusDetails":"playwright._impl._errors.TimeoutError: Page.wait_for_selector: Timeout 30000ms exceeded.\nCall log:\nwaiting for locator(\"//div[@type='error']\") to be visible","time":{"start":1728148776746,"stop":1728148822397,"duration":45651}},{"uid":"20cfd96dd4ef4764","reportUrl":"https://darkbot-io.github.io/qa-website/534//#testresult/20cfd96dd4ef4764","status":"passed","time":{"start":1727543692940,"stop":1727543713349,"duration":20409}},{"uid":"c2da6ceb75b89749","reportUrl":"https://darkbot-io.github.io/qa-website/533//#testresult/c2da6ceb75b89749","status":"failed","statusDetails":"AssertionError: assert 'Available balance 0.397' in 'Available balance 0.4312791421 TRX is not enough to open buy order on market FUND-TRX with amount 2.004 TRX and quantity 6.5834428383706 FUND'\n +  where 'Available balance 0.397' = <built-in method format of str object at 0x7f05432a8770>('0.397')\n +    where <built-in method format of str object at 0x7f05432a8770> = 'Available balance {}'.format\n +  and   'Available balance 0.4312791421 TRX is not enough to open buy order on market FUND-TRX with amount 2.004 TRX and quantity 6.5834428383706 FUND' = get_unsuccessful_toast_message()\n +    where get_unsuccessful_toast_message = <src.pages.notifications.Notifications object at 0x7f05303de1b0>.get_unsuccessful_toast_message","time":{"start":1727271522981,"stop":1727271542145,"duration":19164}},{"uid":"2db57936224cf25a","reportUrl":"https://darkbot-io.github.io/qa-website/532//#testresult/2db57936224cf25a","status":"broken","statusDetails":"requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://dev.api.darkbot.io/auth/login","time":{"start":1726945025630,"stop":1726945026294,"duration":664}},{"uid":"bbdd7f0d8f258247","reportUrl":"https://darkbot-io.github.io/qa-website/531//#testresult/bbdd7f0d8f258247","status":"broken","statusDetails":"requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://dev.api.darkbot.io/auth/login","time":{"start":1726943327772,"stop":1726943328523,"duration":751}},{"uid":"7f8514418b63f373","reportUrl":"https://darkbot-io.github.io/qa-website/529//#testresult/7f8514418b63f373","status":"passed","time":{"start":1726772776658,"stop":1726772795624,"duration":18966}}]},"tags":[]},"source":"adc7c22777b1a549.json","parameterValues":[]}